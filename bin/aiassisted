#!/bin/sh
#
# aiassisted - AI-Assisted Engineering Guidelines Installer
# 
# A POSIX-compliant shell tool for managing .aiassisted directories.
#
# Usage:
#   aiassisted install [--path=DIR] [--verbose] [--quiet]
#   aiassisted update [--force] [--path=DIR] [--verbose] [--quiet]
#   aiassisted check [--path=DIR]
#   aiassisted version
#   aiassisted self-update
#   aiassisted setup-skills [--tool=<opencode|claude>] [--dry-run]
#   aiassisted templates <list|show|init|sync|path|diff> [args...]
#   aiassisted config <show|get|edit|reset|path> [args...]
#   aiassisted help
#

set -e

# Get script directory
# If this is a symlink, resolve to the actual source location
if [ -L "$0" ]; then
    # Resolve symlink to get source directory
    _real_path="$(readlink "$0")"
    if [ "${_real_path#/}" = "$_real_path" ]; then
        # Relative path - make absolute
        _real_path="$(dirname "$0")/$_real_path"
    fi
    SCRIPT_DIR="$(cd "$(dirname "$_real_path")/.." && pwd)"
else
    # Not a symlink - running from source directly
    SCRIPT_DIR="$(cd "$(dirname "$0")/.." && pwd)"
fi

# Export SCRIPT_DIR so the shell runtime can access it
export SCRIPT_DIR

# Execute the shell runtime with all arguments
exec sh "$SCRIPT_DIR/src/shell/core.sh" "$@"
